import { useState } from 'react';
export default function Admin(){
  const [password,setPassword]=useState(''); const [rows,setRows]=useState([]); const [loading,setLoading]=useState(false); const [error,setError]=useState('');
  const load=async()=>{ setLoading(true); setError(''); try{ const res=await fetch('/api/admin-list',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({password})}); const json=await res.json(); if(!res.ok||!json?.ok) throw new Error(json?.error||'Error cargando datos'); setRows(json.rows||[]); }catch(e){ setError(e.message) } finally{ setLoading(false) } };
  return (<div className="min-h-screen bg-gradient-to-b from-slate-50 to-white p-6"><div className="max-w-4xl mx-auto bg-white rounded-2xl shadow-xl p-6"><h1 className="text-2xl font-semibold mb-4">Panel — Confirmados RSVP</h1><div className="flex gap-3 items-end mb-4"><div><label className="block text-sm font-medium">Contraseña de admin</label><input type="password" value={password} onChange={e=>setPassword(e.target.value)} className="border rounded p-2"/></div><button onClick={load} className="bg-emerald-600 text-white px-4 py-2 rounded">Cargar</button>{loading&&<span className="text-sm text-gray-500">Cargando…</span>}</div>{error&&<p className="text-red-600 text-sm mb-3">{error}</p>}<div className="overflow-x-auto"><table className="min-w-full border text-sm"><thead className="bg-slate-100"><tr><th className="border px-2 py-1">Fecha</th><th className="border px-2 py-1">Token</th><th className="border px-2 py-1">Nombre</th><th className="border px-2 py-1">Respuesta</th><th className="border px-2 py-1">Acompañantes</th><th className="border px-2 py-1">Nota</th></tr></thead><tbody>{rows.length===0?(<tr><td className="border px-2 py-2 text-center" colSpan={6}>Sin datos</td></tr>):rows.map((r,i)=>(<tr key={i}><td className="border px-2 py-1">{r.timestamp}</td><td className="border px-2 py-1">{r.token}</td><td className="border px-2 py-1">{r.name}</td><td className="border px-2 py-1">{r.answer}</td><td className="border px-2 py-1">{r.guests}</td><td className="border px-2 py-1">{r.note}</td></tr>))}</tbody></table></div></div></div>);
}
